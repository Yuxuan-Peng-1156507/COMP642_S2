{% extends "base.html" %}

{% block title %}Place Order - Fresh Harvest{% endblock %}

{% block content %}
    <h1>Place Order</h1>
    <form method="post" action="{{ url_for('place_order') }}">
        <h1>Place Order</h1>
        <form method="post" action="{{ url_for('place_order') }}">
            <h2>Select Vegetables</h2>
            {% for veggie in veggies %}
                <input type="checkbox" name="veggies" value="{{ veggie.id }}">
                {{ veggie.display_name }} - {{ veggie.display_price }}
                Quantity: <input type="number" name="quantity_{{ veggie.id }}" value="1" min="1">
                {% if veggie.veg_type == 'weighted' %}
                    Weight (kg): <input type="number" name="weight_{{ veggie.id }}" value="1.0" min="0.1" step="0.1">
                {% endif %}
                <br>
            {% endfor %}
            
            <h2>Select Premade Boxes</h2>
            {% for box in premade_boxes %}
                <input type="checkbox" name="premade_boxes" value="{{ box.id }}">
                {{ box.display_name }} - {{ box.display_price }}
                <br>Contains:
                <ul>
                    {% for veggie in box.veggies %}
                        <li>{{ veggie.veg_name }}</li>
                    {% endfor %}
                </ul>
                Quantity: <input type="number" name="quantity_box_{{ box.id }}" value="1" min="1"><br><br>
            {% endfor %}
            
            <h2>Delivery Option</h2>
            <select name="delivery_option" required>
                <option value="pickup">Pickup</option>
                <option value="delivery">Delivery(10.0$)</option>
            </select><br><br>
    
            <h2>Payment Type</h2>
            <select name="payment_type" id="payment_type" onchange="showPaymentFields()" required>
                <option value="">Select Payment Type</option>
                <option value="credit_card">Credit Card</option>
                <option value="debit_card">Debit Card</option>
                <option value="account">Account Balance</option>
            </select><br><br>
            <div id="credit_card_fields" style="display:none;">
                <h3>Credit Card Information</h3>
                Card Number: <input type="text" name="card_number"><br>
                Expiry Date: <input type="text" name="card_expiry_date"><br>
                Card Type: <input type="text" name="card_type"><br>
            </div>
            <div id="debit_card_fields" style="display:none;">
                <h3>Debit Card Information</h3>
                Bank Name: <input type="text" name="bank_name"><br>
                Card Number: <input type="text" name="debit_card_number"><br>
            </div>
            <input type="submit" value="Submit Order">
        </form>
        {% with messages = get_flashed_messages() %}
          {% if messages %}
            <ul style="color: red;">
            {% for message in messages %}
              <li>{{ message }}</li>
            {% endfor %}
            </ul>
          {% endif %}
        {% endwith %}
        <a href="{{ url_for('customer_dashboard') }}">Back to Dashboard</a>

    <script>
        function showPaymentFields() {
            var paymentType = document.getElementById('payment_type').value;
            document.getElementById('credit_card_fields').style.display = paymentType == 'credit_card' ? 'block' : 'none';
            document.getElementById('debit_card_fields').style.display = paymentType == 'debit_card' ? 'block' : 'none';
        }
    </script>
{% endblock %}



